import{r as t,h as e,H as s,c as n,g as i}from"./p-26f39649.js";import{C as r,P as o,S as l,g as c,a as u}from"./p-92c1beb6.js";const h=class{constructor(e){t(this,e),this.prop=null,this.increase=async()=>{let t=await this.store,e=t.snapshot();e.counter++,t.patch(e)}}async componentDidLoad(){let t=await this.store;this.subscription=t.subscribe(()=>{this.counter=t.snapshot().counter})}disconnectedCallback(){this.subscription.unsubscribe()}render(){return e(s,null,e("state-store-consumer",{consumer:this}),e("div",null,e("div",null,"Current value rendered from consumer component: ",e("span",null,this.counter)),e("div",null,e("button",{onClick:this.increase},"Increase counter from consumer"))))}};!function(t,e,s,n){var i,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,s):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,s,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(o=(r<3?i(o):r>3?i(e,s,o):i(e,s))||o);r>3&&o&&Object.defineProperty(e,s,o)}([r("demo-store"),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:type",Promise)],h.prototype,"store",void 0);const a=class{constructor(e){t(this,e),this.increase=()=>{let t=this.store.snapshot();t.counter++,this.store.patch(t)}}connectedCallback(){this.subscription=this.store.subscribe(t=>{this.counter=t.counter})}disconnectedCallback(){this.subscription.unsubscribe()}render(){return e(s,null,e("state-store-provider",{provider:this}),e("slot",null),e("div",null,e("div",null,"Current value rendered from provider component: ",e("span",null,this.counter)),e("div",null,e("button",{onClick:this.increase},"Increase counter from provider"))))}};!function(t,e,s,n){var i,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,s):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,s,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(o=(r<3?i(o):r>3?i(e,s,o):i(e,s))||o);r>3&&o&&Object.defineProperty(e,s,o)}([o({name:"demo-store",defaults:{counter:1}}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:type",Object)],a.prototype,"store",void 0);class f{constructor(){this._subject=new l}subscribe(t){return this._subject.subscribe(t)}notify(){this._subject.next()}static getInstance(){return f._instance||(f._instance=new f),f._instance}}const d=class{constructor(e){t(this,e),this.requests=[],this.subscription=null,this.request=n(this,"stateStoreConsumerRequest",7)}connectedCallback(){this.requests=c(this.consumer),this.require(),0!==this.requests.length&&(this.subscription=f.getInstance().subscribe(()=>{this.require()}))}disconnectedCallback(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.requests=[]}require(){let t=[];this.requests.forEach(e=>{this.request.emit(e).defaultPrevented&&t.push(e)}),t.forEach(t=>{this.requests.splice(this.requests.indexOf(t),1)}),0===this.requests.length&&null!==this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}render(){return e(s,null,e("slot",null))}},m=class{constructor(e){t(this,e),this.onStoreRequested=t=>{let e=t.detail;if(!this.stores.has(e.name))return;t.stopPropagation(),t.preventDefault();let s=this.stores.get(e.name);e.consumer[e.property].resolve(s)}}connectedCallback(){let t=0!==Array.from(this.el.childNodes).filter(t=>"#comment"!==t.nodeName).length;this.handler=this.el,t||(this.handler=this.el.parentNode),this.handler.addEventListener("stateStoreConsumerRequest",this.onStoreRequested),this.stores=u(this.provider),f.getInstance().notify()}disconnectedCallback(){this.handler.removeEventListener("stateStoreConsumerRequest",this.onStoreRequested)}render(){return e(s,null,e("slot",null))}get el(){return i(this)}};export{h as demo_consumer,a as demo_provider,d as state_store_consumer,m as state_store_provider}