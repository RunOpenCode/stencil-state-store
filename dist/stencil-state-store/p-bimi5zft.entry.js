import{r as e,h as t,H as s,c as r}from"./p-9d59002b.js";import{C as n,P as o,S as i,g as c,a as u}from"./p-89892b30.js";var a=function(e,t,s,r){var n,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,s,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(i=(o<3?n(i):o>3?n(t,s,i):n(t,s))||i);return o>3&&i&&Object.defineProperty(t,s,i),i},l=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class p{constructor(t){e(this,t),this.prop=null}injectStore(e){}onDefaultStoreProvided(e){this.store=e,this.subscription=this.store.subscribe(e=>{this.counter=e.counter})}disconnectedCallback(){this.subscription.unsubscribe()}increase(){let e=this.store.snapshot();e.counter++,this.store.patch(e)}render(){return t(s,null,t("state-store-consumer",{consumer:this}),t("div",null,"Current value rendered from consumer component: ",t("span",null,this.counter)),t("div",null,t("button",{onClick:this.increase.bind(this)},"Increase counter from consumer")))}}a([n({name:"demo-store",callback:"onDefaultStoreProvided"}),l("design:type",Object)],p.prototype,"store",void 0),a([n({name:"demo-store",callback:()=>{}}),l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],p.prototype,"injectStore",null);class h{constructor(t){e(this,t)}connectedCallback(){this.subscription=this.store.subscribe(e=>{this.counter=e.counter})}disconnectedCallback(){this.subscription.unsubscribe()}increase(){let e=this.store.snapshot();e.counter++,this.store.patch(e)}render(){return t("state-store-provider",{provider:this},t("div",null,"Current value rendered from provider component: ",t("span",null,this.counter)),t("div",null,t("button",{onClick:this.increase.bind(this)},"Increase counter from provider")),t("slot",null))}}!function(e,t,s,r){var n,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,s,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(i=(o<3?n(i):o>3?n(t,s,i):n(t,s))||i);o>3&&i&&Object.defineProperty(t,s,i)}([o({name:"demo-store",defaults:{counter:1}}),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:type",Object)],h.prototype,"store",void 0);class d{constructor(){this._subject=new i}subscribe(e){return this._subject.subscribe(e)}notify(){this._subject.next()}static getInstance(){return d._instance||(d._instance=new d),d._instance}}class b{constructor(t){e(this,t),this.requests=[],this.subscription=null,this.request=r(this,"runopencode:store:consumer:request",7)}connectedCallback(){this.requests=c(this.consumer),this.require(),0!==this.requests.length&&(this.subscription=d.getInstance().subscribe(()=>{this.require()}))}disconnectedCallback(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.requests=[]}render(){return t("slot",null)}require(){let e=[];this.requests.forEach(t=>{this.request.emit(t).defaultPrevented&&e.push(t)}),e.forEach(e=>{this.requests.splice(this.requests.indexOf(e),1)}),0===this.requests.length&&null!==this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}}class f{constructor(t){e(this,t)}connectedCallback(){this.stores=u(this.provider),d.getInstance().notify()}onRequest(e){let t=e.detail;if(!this.stores.has(t.name))return;e.stopPropagation(),e.preventDefault();let s=this.stores.get(t.name);t.property&&(t.consumer[t.property]=s),t.method&&t.method.apply(t.consumer,[s]),t.callback&&t.callback.apply(t.consumer,[s])}render(){return t("slot",null)}}export{p as demo_consumer,h as demo_provider,b as state_store_consumer,f as state_store_provider};