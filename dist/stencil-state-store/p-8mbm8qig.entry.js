import{r as e,h as t,H as s,c as n}from"./p-ec2eb55b.js";import{C as o,P as i,S as r,g as c,a as l}from"./p-9dc82ae6.js";var u=function(e,t,s,n){var o,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,s):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(i<3?o(r):i>3?o(t,s,r):o(t,s))||r);return i>3&&r&&Object.defineProperty(t,s,r),r},a=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const h=class{constructor(t){e(this,t),this.prop=null}injectStore(e){console.log("Store injected via method injection.",e)}onDefaultStoreProvided(e){console.log("After store is injected, instance method is invoked.",e),this.store=e,this.subscription=this.store.subscribe(e=>{this.counter=e.counter})}disconnectedCallback(){this.subscription.unsubscribe()}increase(){let e=this.store.snapshot();e.counter++,this.store.patch(e)}render(){return t(s,null,t("state-store-consumer",{consumer:this}),t("div",null,"Current value rendered from consumer component: ",t("span",null,this.counter)),t("div",null,t("button",{onClick:this.increase.bind(this)},"Increase counter from consumer")))}};u([o({name:"demo-store",callback:"onDefaultStoreProvided"}),a("design:type",Object)],h.prototype,"store",void 0),u([o({name:"demo-store",callback:e=>{console.log("After store is injected, callback function is invoked.",e)}}),a("design:type",Function),a("design:paramtypes",[Object]),a("design:returntype",void 0)],h.prototype,"injectStore",null);const d=class{constructor(t){e(this,t)}connectedCallback(){this.subscription=this.store.subscribe(e=>{this.counter=e.counter})}disconnectedCallback(){this.subscription.unsubscribe()}increase(){let e=this.store.snapshot();e.counter++,this.store.patch(e)}render(){return t("state-store-provider",{provider:this},t("div",null,"Current value rendered from provider component: ",t("span",null,this.counter)),t("div",null,t("button",{onClick:this.increase.bind(this)},"Increase counter from provider")),t("slot",null))}};!function(e,t,s,n){var o,i=arguments.length,r=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,s):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(i<3?o(r):i>3?o(t,s,r):o(t,s))||r);i>3&&r&&Object.defineProperty(t,s,r)}([i({name:"demo-store",defaults:{counter:1}}),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:type",Object)],d.prototype,"store",void 0);class f{constructor(){this._subject=new r}subscribe(e){return this._subject.subscribe(e)}notify(){this._subject.next()}static getInstance(){return f._instance||(f._instance=new f),f._instance}}const p=class{constructor(t){e(this,t),this.requests=[],this.subscription=null,this.request=n(this,"runopencode:store:consumer:request",7)}connectedCallback(){this.requests=c(this.consumer),this.require(),0!==this.requests.length&&(this.subscription=f.getInstance().subscribe(()=>{this.require()}))}disconnectedCallback(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.requests=[]}render(){return t("slot",null)}require(){let e=[];this.requests.forEach(t=>{this.request.emit(t).defaultPrevented&&e.push(t)}),e.forEach(e=>{this.requests.splice(this.requests.indexOf(e),1)}),0===this.requests.length&&null!==this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}},m=class{constructor(t){e(this,t)}connectedCallback(){this.stores=l(this.provider),f.getInstance().notify()}onRequest(e){let t=e.detail;if(!this.stores.has(t.name))return;e.stopPropagation(),e.preventDefault();let s=this.stores.get(t.name);t.property&&(t.consumer[t.property]=s),t.method&&t.method.apply(t.consumer,[s]),t.callback&&t.callback.apply(t.consumer,[s])}render(){return t("slot",null)}};export{h as demo_consumer,d as demo_provider,p as state_store_consumer,m as state_store_provider};